r = open('tomsk_almazov ЛКА_LEMME.txt', 'r')
w = open('tomsk_almazov ЛКА_LEMME_no_stopwords.txt', 'w')

def get_stopwords():
    #f = open(filename, 'r')
    arr = []
    #for word in f.readlines():
    #    a = word.split('\t')
    #    if int(a[0]) <= min:
    #        w = a[1][:-1]
    #        arr.append(w)
    #f.close()
    arr.append('в')
    arr.append('с')
    arr.append('на')
    arr.append('мм')
    arr.append('по')
    arr.append('г')
    arr.append('ст')
    arr.append('от')
    arr.append('л')
    arr.append('мг')
    arr.append('рт')
    arr.append('до')
    arr.append('мин')
    arr.append('о')
    arr.append('при')
    arr.append('х')
    arr.append('см')
    arr.append('мл')
    arr.append('после')
    arr.append('а')
    arr.append('и')
    arr.append('х')
    arr.append('р')
    arr.append('к')
    arr.append('м')
    arr.append('за')
    arr.append('для')
    arr.append('н')
    arr.append('п')
    arr.append('со')
    arr.append('б')
    arr.append('из')
    arr.append('зав')
    arr.append('д')
    arr.append('е')
    arr.append('т')
    arr.append('ф')
    arr.append('мкг')
    arr.append('ед')
    arr.append('под')
    arr.append('у')
    arr.append('ю')
    arr.append('ее')
    arr.append('над')
    arr.append('петербург')
    arr.append('санкт')
    arr.append('з')
    arr.append('россия')
    arr.append('ольга')
    arr.append('ч')
    arr.append('проф')
    arr.append('согласие')
    arr.append('ночью')
    arr.append('решения')
    arr.append('зам')
    arr.append('ж')
    arr.append('родственников')
    arr.append('сестра')
    arr.append('сергеевна')
    arr.append('консультирована')
    arr.append('ночь')
    arr.append('иванова')
    arr.append('пациенту')
    arr.append('николаевич')
    arr.append('михаил')
    arr.append('геннадьевна')
    arr.append('македонова')
    arr.append('дежурным')
    arr.append('что')
    arr.append('наблюдался')
    arr.append('гордеевым')
    arr.append('алексей')
    arr.append('снят')
    arr.append('клиники')
    arr.append('консультации')
    arr.append('возраст')
    arr.append('пациентки')
    arr.append('днем')
    arr.append('однако')
    arr.append('персонала')
    arr.append('себя')
    arr.append('оказана')
    arr.append('палату')
    arr.append('самостоятельно')
    arr.append('владимир')
    arr.append('больничный')
    arr.append('владимирович')
    arr.append('леонидович')
    arr.append('сергей')
    arr.append('год')
    arr.append('фгбу')
    arr.append('кардиохирурга')
    arr.append('ирина')
    arr.append('сзфмиц')
    arr.append('гл')
    arr.append('месяца')
    arr.append('ее')
    arr.append('андрей')
    arr.append('нужен')
    arr.append('дмитрий')
    arr.append('лор')
    arr.append('александрова')
    arr.append('гг')
    arr.append('бондаренко')
    arr.append('осмотрена')
    arr.append('э')
    arr.append('фцскэ')
    arr.append('где')
    arr.append('этаж')
    arr.append('марина')
    arr.append('екатерина')
    arr.append('согласован')
    arr.append('утро')
    arr.append('николаевна')
    arr.append('чего')
    arr.append('знает')
    arr.append('алексеевич')
    arr.append('татьяна')
    arr.append('мария')
    arr.append('евгеньевна')
    arr.append('я')
    arr.append('юсифов')
    arr.append('манько')
    arr.append('валерьевич')
    arr.append('игоревна')
    arr.append('отметил')
    arr.append('этого')
    arr.append('были')
    arr.append('есть')
    arr.append('юрьевна')
    arr.append('олегович')
    arr.append('анатольевич')
    arr.append('ые')
    arr.append('дежурной')
    arr.append('всем')
    arr.append('воробьевой')
    arr.append('евгеньевич')
    arr.append('профессиональные')
    arr.append('й')
    arr.append('гордеева')
    arr.append('главный')
    arr.append('яковлев')
    arr.append('рф')
    arr.append('ммртст')
    arr.append('сон')
    arr.append('карпова')
    arr.append('баллов')
    arr.append('викторовна')
    arr.append('стоматологом')
    arr.append('антон')
    arr.append('самсонова')
    arr.append('отец')
    arr.append('либо')
    arr.append('зверев')
    arr.append('соловьева')
    arr.append('викторович')
    arr.append('юрьевич')
    arr.append('обратилась')
    arr.append('нии')
    arr.append('воробьева')
    arr.append('семенов')
    arr.append('крыловой')
    arr.append('андреевич')
    arr.append('документации')
    arr.append('истории')
    arr.append('владиленовна')
    arr.append('коношкова')
    arr.append('беременности')
    arr.append('беременность')
    arr.append('баллы')
    arr.append('еды')
    arr.append('прежней')
    arr.append('ночное')
    arr.append('продолжает')
    arr.append('денис')
    arr.append('апреле')
    arr.append('жуков')
    arr.append('ознакомлена')
    arr.append('керемов')
    arr.append('подготовлена')
    arr.append('дмитриевич')
    arr.append('горького')
    arr.append('оформлена')
    arr.append('поликлинике')
    arr.append('пришел')
    arr.append('добрыниной')
    arr.append('ноябре')
    arr.append('алексеева')
    arr.append('июля')
    arr.append('валентиновна')
    arr.append('дарья')
    arr.append('гневашева')
    arr.append('ходит')
    arr.append('лев')
    arr.append('лечащего')
    arr.append('ооо')
    arr.append('зарегистрированы')
    arr.append('специалист')
    arr.append('детстве')
    arr.append('медикаменты')
    arr.append('текущим')
    arr.append('козлова')
    arr.append('ожидает')
    arr.append('будет')
    arr.append('титова')
    arr.append('тельманович')
    arr.append('вендеровича')
    arr.append('записан')
    arr.append('августа')
    arr.append('другое')
    arr.append('ноября')
    arr.append('лечился')
    arr.append('картины')
    arr.append('работа')
    arr.append('сентября')
    arr.append('мае')
    arr.append('июне')
    arr.append('стелианова')
    arr.append('юрий')
    arr.append('имеют')
    arr.append('тогда')
    arr.append('наблюдалась')
    arr.append('приемом')
    arr.append('дни')
    arr.append('постели')
    arr.append('галина')
    arr.append('степановым')
    arr.append('есиповичем')
    arr.append('проконсультирована')
    arr.append('артемий')
    arr.append('павлова')
    arr.append('олег')
    arr.append('феврале')
    arr.append('алексеевна')
    arr.append('утра')
    arr.append('суровягина')
    arr.append('зарегистрировано')
    arr.append('витковская')
    arr.append('ознакомилась')
    arr.append('баянкина')
    arr.append('пенсионеры')
    arr.append('московская')
    arr.append('руководитель')
    arr.append('апреля')
    arr.append('лестнице')
    arr.append('больнице')
    arr.append('левченко')
    arr.append('мужчина')
    arr.append('уртемеев')
    arr.append('минин')
    arr.append('июле')
    arr.append('брудзинского')
    arr.append('михеева')
    arr.append('виктория')
    arr.append('сеансы')
    arr.append('пациенте')
    arr.append('наблюдались')
    arr.append('декабря')
    arr.append('июня')
    arr.append('виталий')
    arr.append('тимофей')
    arr.append('октября')
    arr.append('иванович')
    arr.append('игорь')
    arr.append('там')
    arr.append('стаж')
    arr.append('константинович')
    arr.append('гребенником')
    arr.append('бросил')
    arr.append('вчера')
    arr.append('врачу')
    arr.append('больному')
    arr.append('крюков')
    arr.append('мскта')
    arr.append('дыбтан')
    arr.append('геннадиевна')
    arr.append('зарегистрирована')
    arr.append('боткина')
    arr.append('две')
    arr.append('таким')
    arr.append('вавиловой')
    arr.append('соловьевой')
    arr.append('ааа')
    arr.append('бригада')
    arr.append('иваниха')
    arr.append('кудаев')
    arr.append('гурьев')
    arr.append('зайцев')
    arr.append('ц')
    arr.append('ташхановым')
    arr.append('кудряшова')
    arr.append('ой')
    arr.append('авторизации')
    arr.append('кандинский')
    arr.append('александра')
    arr.append('александрова')
    arr.append('три')
    arr.append('консультированы')
    arr.append('обсуждением')
    arr.append('вплоть')
    arr.append('михайловна')
    arr.append('симаковым')
    arr.append('разрешение')
    arr.append('вероника')
    arr.append('волков')
    arr.append('выборгский')
    arr.append('пример')
    arr.append('желнинова')
    arr.append('предьявляет')
    arr.append('которая')
    arr.append('семенович')
    arr.append('моносов')
    arr.append('тот')
    arr.append('кулешовой')
    arr.append('влентина')
    arr.append('жердев')
    arr.append('январе')
    arr.append('петр')
    arr.append('успенского')
    arr.append('дневник')
    arr.append('вячеславовна')
    arr.append('учета')
    arr.append('антонова')
    arr.append('которые')
    arr.append('вера')
    arr.append('разрешено')
    arr.append('медиа')
    arr.append('сроку')
    arr.append('гребенник')
    arr.append('ташханов')
    arr.append('калининский')
    arr.append('остается')
    arr.append('витковской')
    arr.append('та')
    arr.append('чуть')
    arr.append('проживает')
    arr.append('напротив')
    arr.append('андреевна')
    arr.append('анатолий')
    arr.append('ганенко')
    arr.append('спал')
    arr.append('невский')
    arr.append('приморский')
    arr.append('имею')
    arr.append('пациентом')
    arr.append('богачева')
    arr.append('белякова')
    arr.append('агаев')
    arr.append('них')
    arr.append('согласованы')
    arr.append('ленина')
    arr.append('руководителем')
    arr.append('печатников')
    arr.append('они')
    arr.append('брат')
    arr.append('беловой')
    arr.append('этажа')
    arr.append('врачей')
    arr.append('есипович')
    arr.append('фрунзенский')
    arr.append('она')
    arr.append('контролирует')
    arr.append('дьяченко')
    arr.append('пытается')
    arr.append('новгород')
    arr.append('полина')
    arr.append('довольская')
    arr.append('альбертович')
    arr.append('дома')
    arr.append('елисеевым')
    arr.append('фролов')
    arr.append('имела')
    arr.append('ибрагимов')
    arr.append('выпотов')
    arr.append('хрулева')
    arr.append('медсестра')
    arr.append('стажем')
    arr.append('лавренкова')
    arr.append('борцовой')
    arr.append('рамиль')
    arr.append('саламович')
    arr.append('кесарево')
    arr.append('исаковым')
    arr.append('кучеренко')
    arr.append('никита')
    arr.append('глебовской')
    arr.append('явился')
    arr.append('тем')
    arr.append('пришла')
    arr.append('иванова')
    arr.append('титов')
    arr.append('владислав')
    arr.append('обращение')
    arr.append('мазохина')
    arr.append('витальевич')
    arr.append('ох')
    arr.append('наталия')
    arr.append('великий')
    arr.append('рфп')
    arr.append('сальника')
    arr.append('мозалев')
    arr.append('имранович')
    arr.append('имран')
    arr.append('валентинович')
    arr.append('крюковым')
    arr.append('проходила')
    arr.append('этими')
    arr.append('окна')
    arr.append('начиная')
    arr.append('него')
    arr.append('имело')
    arr.append('петрович')
    arr.append('матери')
    arr.append('выполнила')
    arr.append('давыдов')
    arr.append('освоил')
    arr.append('федоренко')
    arr.append('взрослых')
    arr.append('консилиума')
    arr.append('васильевна')
    arr.append('щ')
    arr.append('февраля')
    arr.append('никитин')
    arr.append('головина')
    arr.append('якунина')
    arr.append('рузанов')
    arr.append('дневные')
    arr.append('юсифовым')
    arr.append('занимался')
    arr.append('любовь')
    arr.append('полозова')
    arr.append('ней')
    arr.append('симаков')
    arr.append('комиссия')
    arr.append('водителя')
    arr.append('фокиным')
    arr.append('пахоменко')
    arr.append('шишкова')
    arr.append('документация')
    arr.append('ночного')
    arr.append('трех')
    arr.append('лебедева')
    arr.append('карташовой')
    arr.append('гатчина')
    arr.append('кузьмина')
    arr.append('мороз')
    arr.append('этот')
    arr.append('белова')
    arr.append('если')
    arr.append('муртазалиева')
    arr.append('чернявский')
    arr.append('кабанова')
    arr.append('калашниковым')
    arr.append('прошла')
    arr.append('морозм')
    arr.append('покровской')
    arr.append('вечеру')
    arr.append('ты')
    arr.append('демченко')
    arr.append('графтов')
    arr.append('графтом')
    arr.append('инженер')
    arr.append('красногвардейский')
    arr.append('фцскиэ')
    arr.append('жуковым')
    arr.append('туйнова')
    arr.append('молодости')
    arr.append('федоров')
    arr.append('кировским')
    arr.append('керемовым')
    arr.append('борцова')
    arr.append('кудьтурный')
    arr.append('всеми')
    arr.append('занимается')
    arr.append('вадимовна')
    arr.append('муртазалиевна')
    arr.append('попова')
    arr.append('фио')
    arr.append('которую')
    arr.append('млмоль')
    arr.append('врачам')
    arr.append('май')
    arr.append('полгода')
    arr.append('хоменко')
    arr.append('курьянов')
    arr.append('возрастом')
    arr.append('записана')
    arr.append('леонидовная')
    arr.append('водитель')
    arr.append('кесарева')
    arr.append('николайчук')
    arr.append('павлов')
    arr.append('валиуллина')
    arr.append('вместе')
    arr.append('некоторая')
    arr.append('вечера')
    arr.append('ый')
    arr.append('собой')
    arr.append('гатчинский')
    arr.append('артефакты')
    arr.append('пациенткой')
    arr.append('ярков')
    arr.append('горяинов')
    arr.append('всю')
    arr.append('соболева')
    arr.append('кузнецов')
    arr.append('одела')
    arr.append('кузьмин')
    arr.append('молодого')
    arr.append('бухарова')
    arr.append('согласен')
    arr.append('заяшниковым')
    arr.append('ся')
    arr.append('рамилевна')
    arr.append('топтыгин')
    arr.append('ильинской')
    arr.append('краснов')
    arr.append('германовна')
    arr.append('летом')
    arr.append('лестницы')
    arr.append('гусевым')
    arr.append('годы')
    arr.append('павловна')
    arr.append('внутригородской')
    arr.append('краснощекой')
    arr.append('санаторное')
    arr.append('бригадой')
    arr.append('санакоевой')
    arr.append('этим')
    arr.append('клексана')
    arr.append('предупрежден')
    arr.append('предьявлял')
    arr.append('михайловой')
    arr.append('организации')
    arr.append('трижды')
    arr.append('сонлив')
    arr.append('нее')
    arr.append('материнской')
    arr.append('зоя')
    arr.append('рядом')
    arr.append('савиных')
    arr.append('минздрава')
    arr.append('медина')
    arr.append('весной')
    arr.append('вачаганович')
    arr.append('вртур')
    arr.append('неходжкинская')
    arr.append('диана')
    arr.append('цинковой')
    arr.append('какой')
    arr.append('павел')
    arr.append('всему')
    arr.append('тишкова')
    arr.append('шелкова')
    arr.append('можно')
    arr.append('сотрудником')
    arr.append('водителем')
    arr.append('про')
    arr.append('матакаевой')
    arr.append('сеанса')
    arr.append('подсчет')
    arr.append('павловой')
    arr.append('станислав')
    arr.append('никитина')
    arr.append('технической')
    arr.append('георгий')
    arr.append('прежним')
    arr.append('картиной')
    arr.append('пугачева')
    arr.append('дочь')
    arr.append('геннадий')
    arr.append('пискарева')
    arr.append('толпыгиным')
    arr.append('шатравкой')
    arr.append('маратович')
    arr.append('кирилл')
    arr.append('начальник')
    arr.append('красносельский')
    arr.append('арбенина')
    arr.append('григорьевич')
    arr.append('сад')
    arr.append('александровской')
    arr.append('имомкулович')
    arr.append('вега')
    arr.append('дакроновой')
    arr.append('всеволожский')
    arr.append('завтрака')
    arr.append('ильинишна')
    arr.append('этой')
    arr.append('директора')
    arr.append('ом')
    arr.append('койкодень')
    arr.append('царегородцевым')
    arr.append('вся')
    arr.append('мечникова')
    arr.append('палатный')
    arr.append('данилов')
    arr.append('обыденникова')
    arr.append('павлович')
    arr.append('воробьевой')
    arr.append('смоленская')
    arr.append('тренажере')
    arr.append('одно')
    arr.append('коми')
    arr.append('софья')
    arr.append('фарида')
    arr.append('умаровна')
    arr.append('женщин')
    arr.append('специалиста')
    arr.append('клинике')
    arr.append('фл')
    arr.append('ву')
    arr.append('гордиенко')
    arr.append('весь')
    arr.append('сын')
    arr.append('ночи')
    arr.append('кафедрой')
    arr.append('работала')
    arr.append('детей')
    arr.append('родился')
    arr.append('картавенко')
    arr.append('какого')
    arr.append('лютынской')
    arr.append('язневич')
    arr.append('алена')
    arr.append('першина')
    arr.append('бакулева')
    arr.append('начмедом')
    arr.append('дневный')
    arr.append('алексеевой')
    return arr

import re
from nltk.tokenize import word_tokenize

stopwords = get_stopwords()

for line in r.readlines():
    a = line.split('\t')
    text = a[1][:-1]
    text = text.lower()
    text = re.sub(r'[^а-я0-9% ё]+', ' ', text)
    text = re.sub(r' +', ' ', text)
    text = text.replace('ё', 'е')
    text = text.replace('ъ', 'ь')
    words = text.split()
    words = [w for w in words if not w in stopwords]
    text = ' '.join(words)
    w.write(a[0]+ '\t'+text +'\n')

r.close()
w.close()
